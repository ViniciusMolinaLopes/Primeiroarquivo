# Atividade_Final_DSW
Codigo da atividadeLISTADOS OS ARQUIVOS ACIMA O SISTEMA CRIADO COM A 
PAGINA INICIAL EM INDEX1.HTML LISTA LINKS DE CONEXÃO 
PARA AS DETERMINADAS FUNÇÕES MAS APENAS AS FUNÇÕES DE CADASTRO 
DE DICIPLINA E ESTUDANTE FUNCIONAVAM E AS DEMAIS NEM COLOQUEI , POIS NÃO LEVAM A  NADA.
 COMECEI A CRIAR O ESTILO MAS PAREI QUANDO ENCONTREI UMA DIFICULDADE EM PUXAR OS
 DADOS DE QUALQUER TABELA PELO COMANDO 
SELECT DO SQL SERVER ONDE A VARIAVEL NÃO RETORNAVA NADA , ENTÃO NÃO CONSEGUIA RELACIONAR
AS TABELAS CRIADAS PARA INSERIR DADOS DA MANEIRA CORRETA E SEGURA NO BANCO DE DADOS JÁ QUE 
DEPENDE-SE DO ID PARA RELACIONA-LAS.
TRECHO DO PROBLEMA:		     
             <?php if($nome!=''and $diciplina!=''){
			 $select = "SELECT CD_DICIPLINA FROM DICIPLINA WHERE NM_DICIPLINA =$diciplina";
			 $envio = sqlsrv_query($resultado,$select );
		     $select1 = "SELECT CD_ESTUDANTE FROM ESTUDANTE WHERE NM_ESTUDANTE =$nome";
			 $envio1 = sqlsrv_query($resultado,$select1 );
             echo ($envio);
	           $cadEstudante = "INSERT INTO DICIPLINA_ESTUDANTE(ID_DICIPLINA , ID_ESTUDANTE) VALUES(?,?)";
			   $parametros = array($envio,$envio1);
			   $envio2 =sqlsrv_query($resultado ,$cadEstudante,$parametros);
			 
                if ($envio2) {  
                echo "Cadastrado com sucesso.\n";  
              } else {  
                 echo "Row insertion failed.\n";  
                die(print_r(sqlsrv_errors(), true)); }
           }?>
A VARIÁVEL $envio COMO SUAS DEMAIS VARIANTES (1,2) ERAM NECESSÁRIAS PARA PROSEGUIR E MESMO DEPOIS DE MUITA 
PESQUISA NÃO ENCONTREI SOLUÇÃO . ESSE TRECHO SE TRATA DE LINKAR O ESTUDANTE COM A DICIPLINA SELECIONADA JÁ QUE
CADA CADASTRO É FEITO SEPARADAMENTE, A FUNÇÃO É VERIFICAR A EXISTÊNCIA DO ESTUDANTE E DICIPLINA NA BASE DE DADOS
 E OS INCLUIR UMA RELAÇÃO COMO OBSERVADO ABAIXO:

 CREATE TABLE DICIPLINA(
CD_DICIPLINA INT IDENTITY(1111,1) PRIMARY KEY NOT NULL,
NM_DICIPLINA VARCHAR(30) NOT NULL
)
LISTADOS OS ARQUIVOS ACIMA O SISTEMA CRIADO COM A 
PAGINA INICIAL EM INDEX1.HTML LISTA LINKS DE CONEXÃO 
PARA AS DETERMINADAS FUNÇÕES MAS APENAS AS FUNÇÕES DE CADASTRO 
DE DICIPLINA E ESTUDANTE FUNCIONAVAM E AS DEMAIS NEM COLOQUEI , POIS NÃO LEVAM A  NADA.
 COMECEI A CRIAR O ESTILO MAS PAREI QUANDO ENCONTREI UMA DIFICULDADE EM PUXAR OS
 DADOS DE QUALQUER TABELA PELO COMANDO 
SELECT DO SQL SERVER ONDE A VARIAVEL NÃO RETORNAVA NADA , ENTÃO NÃO CONSEGUIA RELACIONAR
AS TABELAS CRIADAS PARA INSERIR DADOS DA MANEIRA CORRETA E SEGURA NO BANCO DE DADOS JÁ QUE 
DEPENDE-SE DO ID PARA RELACIONA-LAS.
TRECHO DO PROBLEMA:		     
             <?php if($nome!=''and $diciplina!=''){
			 $select = "SELECT CD_DICIPLINA FROM DICIPLINA WHERE NM_DICIPLINA =$diciplina";
			 $envio = sqlsrv_query($resultado,$select );
		     $select1 = "SELECT CD_ESTUDANTE FROM ESTUDANTE WHERE NM_ESTUDANTE =$nome";
			 $envio1 = sqlsrv_query($resultado,$select1 );
             echo ($envio);
	           $cadEstudante = "INSERT INTO DICIPLINA_ESTUDANTE(ID_DICIPLINA , ID_ESTUDANTE) VALUES(?,?)";
			   $parametros = array($envio,$envio1);
			   $envio2 =sqlsrv_query($resultado ,$cadEstudante,$parametros);
			 
                if ($envio2) {  
                echo "Cadastrado com sucesso.\n";  
              } else {  
                 echo "Row insertion failed.\n";  
                die(print_r(sqlsrv_errors(), true)); }
           }?>
A VARIÁVEL $envio COMO SUAS DEMAIS VARIANTES (1,2) ERAM NECESSÁRIAS PARA PROSEGUIR E MESMO DEPOIS DE MUITA 
PESQUISA NÃO ENCONTREI SOLUÇÃO . ESSE TRECHO SE TRATA DE LINKAR O ESTUDANTE COM A DICIPLINA SELECIONADA JÁ QUE
CADA CADASTRO É FEITO SEPARADAMENTE, A FUNÇÃO É VERIFICAR A EXISTÊNCIA DO ESTUDANTE E DICIPLINA NA BASE DE DADOS
 E OS INCLUIR UMA RELAÇÃO COMO OBSERVADO ABAIXO:
 
 
 
 
 
 
 

 CREATE TABLE DICIPLINA(
CD_DICIPLINA INT IDENTITY(1111,1) PRIMARY KEY NOT NULL,
NM_DICIPLINA VARCHAR(30) NOT NULL
)

//ESSA TABELA ABAIXO:

CREATE TABLE DICIPLINA_ESTUDANTE(
ID_DICIPLINA INT NOT NULL,
ID_ESTUDANTE INT NOT NULL,
CONSTRAINT FK_DI FOREIGN KEY(ID_DICIPLINA)REFERENCES DICIPLINA(CD_DICIPLINA),
CONSTRAINT FK_D_E FOREIGN KEY(ID_ESTUDANTE)REFERENCES ESTUDANTE(CD_ESTUDANTE)
)


CREATE TABLE ESTUDANTE(
CD_ESTUDANTE INT IDENTITY(22222,1) PRIMARY KEY NOT NULL,
NM_ESTUDANTE VARCHAR(50) NOT NULL,
E_MAIL VARCHAR(40) NULL
)


CREATE TABLE CEP (
CD_CEP INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
CEP INT NOT NULL,
RUA VARCHAR(50)NULL,
NUMERO INT NULL,
BAIRRO VARCHAR(20)NULL,
CIDADE VARCHAR(20)NULL,
ESTADO VARCHAR(2),
CD_ESTUDANTE INT NOT NULL,
CONSTRAINT FK_CEP FOREIGN KEY(CD_ESTUDANTE)REFERENCES ESTUDANTE(CD_ESTUDANTE)
)


CREATE TABLE TELEFONE (
CD_TELEFONE INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
DDD INT NULL,
CD_ESTADO INT NULL,
NUMERO INT NOT NULL,
CD_ESTUDANTE INT NOT NULL,
CONSTRAINT FK_TELEFONE FOREIGN KEY(CD_ESTUDANTE)REFERENCES ESTUDANTE(CD_ESTUDANTE)
)


CREATE TABLE NOTAS(
CD_NOTAS INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
NOTA1 INT NOT NULL,
NOTA2 INT NOT NULL,
NOTA3 INT NOT NULL,
CD_ESTUDANTE INT NOT NULL,
CONSTRAINT FK_NOTAS_E FOREIGN KEY(CD_ESTUDANTE)REFERENCES ESTUDANTE(CD_ESTUDANTE)
)

ERRO RECORRENTE:




Row insertion failed. Array ( [0] => Array ( [0] => 23000 [SQLSTATE] => 
23000 [1] => 547 [code] => 547 [2] => [Microsoft][ODBC Driver 17 for SQL Server]
[SQL Server]Conflito entre a instru��o INSERT e a restri��o FOREIGN KEY "FK_DI". 
O conflito ocorreu na base de dados "ATIVIDADE_FINAL", tabela "dbo.DICIPLINA", column
 'CD_DICIPLINA'. [message] => [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Conflito
 entre a instru��o INSERT e a restri��o FOREIGN KEY "FK_DI". O conflito ocorreu na base de 
 dados "ATIVIDADE_FINAL", tabela "dbo.DICIPLINA", column 'CD_DICIPLINA'. ) 
 [1] => Array ( [0] => 01000 [SQLSTATE] => 01000 [1] => 3621 [code] => 
 3621 [2] => [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]A instru��o foi 
 terminada. [message] => [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]
 A instru��o foi terminada. )
 
 
 
 
 
 
 
 MAS QUANDO APENAS INSERI OS IDs DE FORMA MANUAL ELA FUNCIONOU
